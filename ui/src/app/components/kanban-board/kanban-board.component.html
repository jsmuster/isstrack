<!-- Kanban Board Container -->
<div class="kanban-board-container">
  <div class="kanban-error" *ngIf="errorMessage()">{{ errorMessage() }}</div>

  <div class="kanban-columns" cdkDropListGroup>
    @for (column of columns(); track column.status; let columnIndex = $index) {
    <section class="kanban-column">
      <div class="column-header">
        <div class="column-title-wrapper">
          <h3 class="column-title">{{ formatStatusLabel(column.status) }}</h3>
          <div class="issue-count">{{ column.issues.length }}</div>
        </div>
      </div>

      <div
        class="scrollable-list"
        cdkDropList
        [id]="columnIds()[columnIndex]"
        [cdkDropListData]="column.issues"
        (cdkDropListDropped)="onCardDrop($event, column)"
      >
        <article
          class="issue-card"
          role="button"
          tabindex="0"
          *ngFor="let issue of column.issues"
          cdkDrag
          [cdkDragData]="issue"
          (cdkDragStarted)="onDragStarted()"
          (click)="onIssueClick(issue)"
          (keydown.enter)="onIssueClick(issue)"
        >
          <div class="card-header">
            <span class="issue-id">#{{ issue.id }}</span>
          </div>
          <div class="card-body">
            <p class="issue-title">{{ issue.title }}</p>
            <div class="card-tags" *ngIf="issue.tags?.length">
              <span class="tag" *ngFor="let tag of issue.tags" [class]="getTagClass(tag)">{{ tag }}</span>
            </div>
          </div>
          <div class="card-footer">
            <div class="priority-badge" [class]="getPriorityClass(issue.priority)">{{ issue.priority }}</div>
            <div class="assignee-pill">
              <span class="assignee-label">{{ toAssigneeLabel(issue.assigneeUserId) }}</span>
            </div>
            <span class="timestamp">{{ formatTimestamp(issue.updatedAt) }}</span>
          </div>
        </article>

        <div class="empty-state" *ngIf="column.issues.length === 0">
          <img class="empty-icon" alt="No issues" src="/assets/images/i13.svg" />
          <p class="empty-message">No issues in this status</p>
        </div>

      </div>

      <div class="column-actions">
        <button
          class="btn-add-issue"
          (click)="onAddIssue(column.status)"
          type="button"
          aria-label="Add new issue to {{ formatStatusLabel(column.status) }} column"
        >
          <img class="icon-add" alt="Add icon" src="/assets/images/i12.svg" />
          <span class="btn-text">Add issue</span>
        </button>
      </div>
    </section>
    }
  </div>

  <footer class="kanban-footer">
    <div class="pagination-info">
      {{ paginationLabel || 'Showing 0 issues' }}
    </div>

    <div class="pagination-controls">
      <button
        class="btn-pagination-prev"
        (click)="onPreviousPage()"
        type="button"
        [disabled]="!hasPrevPage"
        aria-label="Previous page"
      >
        <img class="icon-nav" alt="Previous" src="/assets/images/button1.svg" />
      </button>

      <button class="btn-page-number active" type="button" aria-current="page">{{ currentPage }}</button>

      <button
        class="btn-pagination-next"
        (click)="onNextPage()"
        type="button"
        [disabled]="!hasNextPage"
        aria-label="Next page"
      >
        <img class="icon-nav" alt="Next" src="/assets/images/button2.svg" />
      </button>
    </div>
  </footer>
</div>
